Refactor Mocks using macro-based automatic generation.

